<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Spinner?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<VBox spacing="20" styleClass="root" stylesheets="@../css/style.css" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="id.syafira.dapoer.controller.OrderController">
    <padding>
        <Insets bottom="16" left="16" right="16" top="16" />
    </padding>

    <HBox alignment="CENTER" spacing="16" VBox.vgrow="ALWAYS">
        <!-- LEFT COLUMN: ORDER INFO & MENU LIST -->
        <VBox spacing="16" HBox.hgrow="SOMETIMES">
             <VBox spacing="16" styleClass="content-card">
                 <Label styleClass="header-label" text="Informasi Pesanan" />
                 <GridPane hgap="16.0" vgap="12.0">
                     <columnConstraints>
                        <ColumnConstraints hgrow="NEVER" minWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="150.0" />
                        <ColumnConstraints hgrow="NEVER" minWidth="100.0" />
                        <ColumnConstraints hgrow="SOMETIMES" minWidth="150.0" />
                     </columnConstraints>
                     <rowConstraints>
                        <RowConstraints vgrow="NEVER" />
                        <RowConstraints vgrow="NEVER" />
                        <RowConstraints vgrow="NEVER" />
                     </rowConstraints>
                     <children>
                         <!-- Row 0 -->
                        <Label style="-fx-font-weight: bold;" text="Tanggal" />
                        <Label fx:id="tanggalLabel" styleClass="text-muted" text="-" GridPane.columnIndex="1" />
                        
                        <Label style="-fx-font-weight: bold;" text="Kasir" GridPane.columnIndex="2" />
                        <Label fx:id="kasirLabel" styleClass="text-muted" text="-" GridPane.columnIndex="3" />

                        <!-- Row 1 -->
                        <Label style="-fx-font-weight: bold;" text="Pelanggan" GridPane.rowIndex="1" />
                        <ComboBox fx:id="pelangganCombo" maxWidth="Infinity" promptText="Pilih Pelanggan" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                        
                        <Label style="-fx-font-weight: bold;" text="Jenis Order" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                        <ComboBox fx:id="jenisPesananCombo" maxWidth="Infinity" promptText="Pilih Jenis" GridPane.columnIndex="3" GridPane.rowIndex="1" />

                        <!-- Row 2 -->
                        <Label style="-fx-font-weight: bold;" text="Tgl Kirim" GridPane.rowIndex="2" />
                        <DatePicker fx:id="tglKirimDate" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                     </children>
                 </GridPane>
             </VBox>

             <VBox spacing="12" styleClass="content-card" VBox.vgrow="ALWAYS">
                 <HBox alignment="CENTER_LEFT" spacing="10">
                     <Label styleClass="sub-header-label" text="Daftar Menu" />
                     <Region HBox.hgrow="SOMETIMES" />
                     <TextField fx:id="pencarianField" prefWidth="200" promptText="Cari Menu..." />
                 </HBox>
                 
                 <TableView fx:id="menuTable" VBox.vgrow="ALWAYS">
                      <columns>
                         <TableColumn fx:id="colMenuNama" prefWidth="150.0" text="Nama Menu" />
                         <TableColumn fx:id="colMenuHarga" prefWidth="100.0" text="Harga" />
                         <TableColumn fx:id="colMenuStok" prefWidth="80.0" text="Stok" />
                      </columns>
                      <columnResizePolicy>
                         <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                      </columnResizePolicy>
                 </TableView>
                 
                 <HBox alignment="CENTER_LEFT" spacing="16">
                     <GridPane hgap="10" vgap="4" HBox.hgrow="ALWAYS">
                         <columnConstraints>
                             <ColumnConstraints minWidth="80" />
                             <ColumnConstraints hgrow="SOMETIMES" />
                         </columnConstraints>
                         <rowConstraints>
                             <RowConstraints />
                             <RowConstraints />
                         </rowConstraints>
                         <children>
                             <Label style="-fx-font-weight: bold;" text="Menu:" />
                             <Label fx:id="namaMenuLabel" styleClass="text-muted" text="-" GridPane.columnIndex="1" />
                             <Label style="-fx-font-weight: bold;" text="Harga:" GridPane.rowIndex="1" />
                             <Label fx:id="hargaMenuLabel" styleClass="text-primary" text="-" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                         </children>
                     </GridPane>
                     <Button fx:id="tambahBtn" onAction="#handleTambahItem" styleClass="button" text="Tambah ke Cart" />
                 </HBox>
             </VBox>
        </VBox>
      <VBox maxWidth="360.0" spacing="12" styleClass="content-card" HBox.hgrow="NEVER">
         <children>
            <Label styleClass="header-label" text="Keranjang Pesanan" />
            <GridPane hgap="10" vgap="10">
               <columnConstraints>
                  <ColumnConstraints minWidth="60" />
                  <ColumnConstraints hgrow="NEVER" />
               </columnConstraints>
               <rowConstraints>
                  <RowConstraints />
                  <RowConstraints />
               </rowConstraints>
               <children>
                  <Label style="-fx-font-weight: bold;" text="Jumlah" />
                  <Spinner fx:id="qtySpinner" editable="true" maxWidth="100" GridPane.columnIndex="1" />
                  <Label style="-fx-font-weight: bold;" text="Catatan" GridPane.rowIndex="1" GridPane.valignment="TOP" />
                  <TextArea fx:id="catatanArea" prefRowCount="3" wrapText="true" GridPane.columnIndex="1" GridPane.rowIndex="1" />
               </children>
            </GridPane>
            <HBox spacing="10">
               <children>
                  <Button fx:id="editBtn" maxWidth="Infinity" onAction="#handleEditItem" styleClass="button-secondary" text="Ubah Qty" HBox.hgrow="ALWAYS" />
                  <Button fx:id="hapusBtn" maxWidth="Infinity" onAction="#handleHapusItem" styleClass="button-danger" text="Hapus" HBox.hgrow="ALWAYS" />
               </children>
            </HBox>
            <TableView fx:id="detailTable" VBox.vgrow="ALWAYS">
               <columns>
                  <TableColumn fx:id="colDetailMenu" text="Menu" />
                  <TableColumn fx:id="colDetailQty" prefWidth="50" style="-fx-alignment: center;" text="Qty" />
                  <TableColumn fx:id="colDetailSubtotal" style="-fx-alignment: center-right;" text="Subtotal" />
               </columns>
               <columnResizePolicy>
                  <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
               </columnResizePolicy>
            </TableView>
            <Separator />
            <HBox alignment="CENTER_RIGHT" spacing="10">
               <children>
                  <Label style="-fx-font-size: 16px;" text="Total:" />
                  <Label fx:id="totalLabel" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #10B981;" text="Rp 0" />
               </children>
            </HBox>
            <Button fx:id="pesanBtn" maxWidth="Infinity" onAction="#handlePesanSekarang" prefHeight="45" styleClass="button" text="SIMPAN PESANAN" />
         </children>
      </VBox>
    </HBox>
</VBox>
